<!DOCTYPE html>
<html lang="en" ng-app>
<head>
  <!-- Use correct character set. -->
  <meta charset="utf-8">
  <!-- Tell IE to use the latest, best version. -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <title>Hello World!</title>
  <script src="../Build/Cesium/Cesium.js"></script>
  <script src='../js/libs/jquery-1.8.0.min.js' type='text/javascript'></script>
  <script src='../js/libs/papaparse.min.js' type='text/javascript'></script>
  <script src="../js/loader/IndoorGMLLoader.js"></script>
  <script type="text/javascript" src="Sandcastle/Sandcastle-header.js"></script>
    <!-- Model -->
  <script src='../js/model/Dictionary.js' type='text/javascript'></script>
  <script src='../js/model/Model.js' type='text/javascript'></script>
  <script src="../js/viewer.js"></script>

  <script src="../js/MovingFeature.js"></script>
  <script src="../js/test.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.1/angular.min.js"></script>
  <!-- <script src="../filewrite.js"></script>-->
      <script async="" src="https://cdn.rawgit.com/eligrey/FileSaver.js/e9d941381475b5df8b7d7691013401e171014e89/FileSaver.min.js"/></script>
  <script src="../js/Loader.js"></script>


  <script src="http://jpillora.com/jquery.rest/dist/1/jquery.rest.min.js"></script>
  <style>
      @import url(../Build/Cesium/Widgets/widgets.css);
      html, body, #cesiumContainer {
          width: 100%; height: 100%; margin: 0; padding: 0; overflow: auto;
      }

  </style>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  <script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  <style>
    @import url(Sandcastle/templates/bucket.css);
     #toolbar {
        background: rgba(42, 42, 42, 0.8);
        padding: 2px;
        border-radius: 4px;
    }
    #toolbar input {
        vertical-align: middle;
        padding-top: 2px;
        padding-bottom: 2px;
    }
</style>
</head>
<body>


<div id="cesiumContainer" class="fullSize"></div>
<div  id ="toolbar">
    <label style ="color:white">IndoorGML : <input type="file" id="fileinput" onchange='readText(this)' text = "file select"></label></br>
    <label style ="color:white">MovingFeature : <input type="file" id="fileinputmf" onchange='readText(this)' ></label></br>
    <label style ="color:white">floor list : <input type="text" id="floor" size="2"></label>
     <button onclick="enableFloor()">view</button></br>
     <label style ="color:white">URL : <input type="text" id="url" size="8"></label>
     <label style ="color:white">Type Name : <input type="text" id="qtype" size="4"></label>
     <label style ="color:white">Envelope : <input type="text" id="box" size="10"></label>
     <button onclick="requestWFS()">Request</button>
     <button onclick="clearHighLight()">Clear HighLight</button></br>
    <!--<button onclick="restart();" >start</button>
    <button onclick="viewer.zoomTo(viewer.entities);">zoom</button>
    <button onclick="toggleNetwork();" >toggle network</button></br>-->
   <!-- <label style ="color:white">IndoorGML size : <input type="text" id="scale" onchange='userScale = this.value' size="2"></label>

    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;

    <label style ="color:white">MovingFeature size :  <input type="text" id="radii" onchange='radii = this.value*1' size="2"></label>
   &nbsp; &nbsp; &nbsp; &nbsp;
    <label style ="color:white">tranlate x : <input type="text" id="trans" onchange='x = this.value*1' size="2"></label>

    <label style ="color:white">tranlate y : <input type="text" id="trans" onchange='y = this.value*1' size="2"></label>-->
    <!--<label style ="color:white"><input type="checkbox" id="stair" checked = 'true' onchange ='changecolor(3,this.checked)'>stair</label>
    <label style ="color:white"><input type="checkbox" id="room" checked = 'true' onchange ='changecolor(1,this.checked)'>room</label>
    <label style ="color:white"><input type="checkbox" id="corridor" checked = 'true' onchange ='changecolor(2,this.checked)'>corridor</label>
    <label style ="color:white"><input type="checkbox" id="door" checked = 'true' onchange ='changecolor(4,this.checked)'>door</label></br>
-->
     </div>
<div id="dialog" title="WFS result">
<p id ="content"></p>
</div>




  <script>
  viewer = new Cesium.Viewer('cesiumContainer');
    //viewer.scene.scene3DOnly = true;
    var options = [{
      text : 'select'
    },{
        text : 'polyline',
        onselect : function() {
            var envelope = document.getElementById("box").value;
            drawPolyline(envelope);
            FilterGeom = "<ogc:Intersects>" +
                          "<ogc:PropertyName>topp:geom</ogc:PropertyName>" +
                          "<gml:LineString srsName=\"http://www.opengis.net/gml/srs/epsg.xml#4327\">" +
                          "<gml:coordinates>" +
                          envelope +
                          "</gml:coordinates>" +
                          "</gml:LineString>" +
                            "</ogc:Intersects>";

        }
    }, {
        text : 'surface',
        onselect : function() {
            var envelope = document.getElementById("box").value;
            drawPolygon(envelope);
            FilterGeom = "<ogc:Intersects>" +
                         "<ogc:PropertyName>topp:geom</ogc:PropertyName>" +
                          "<gml:Polygon srsName=\"http://www.opengis.net/gml/srs/epsg.xml#4327\">" +
                          "<gml:outerBoundaryIs>" +
                          "<gml:LinearRing>" +
                          "<gml:coordinates>" +
                          envelope +
                          "</gml:coordinates>" +
                          "</gml:LinearRing>" +
                          "</gml:outerBoundaryIs>" +
                          "</gml:Polygon>" +
                               "</ogc:Intersects>";

        }
    }, {
        text : 'solid',
        onselect : function() {
            var envelope = document.getElementById("box").value;
            drawSolid(envelope);
            FilterGeom = "<ogc:BBOX>" +
                         "<ogc:PropertyName>topp:geom</ogc:PropertyName>" +
                         "<gml:Box srsName=\"http://www.opengis.net/gml/srs/epsg.xml#4327\">" +
                            "<gml:coordinates>" +
                                envelope +
                            "</gml:coordinates>" +
                         "</gml:Box>" +
                       "</ogc:BBOX>";
        }
    }];

    Sandcastle.addToolbarMenu(options);
    Sandcastle.addToolbarButton('viewAll', viewAll());
    Sandcastle.addToolbarButton('toggle network', toggleNetwork());
    Sandcastle.addToolbarButton('start', restart());

    postDataMETA1 = "<?xml version=\"1.0\" encoding=\"UTF-8\"?> <wfs:GetFeature service=\"WFS3D\" version=\"1.0.0\"" +
 " outputFormat=\"JSON\"" +
 " xmlns:topp=\"http://www.openplans.org/topp\"" +
 " xmlns:wfs=\"http://www.opengis.net/wfs\"" +
 " xmlns:ogc=\"http://www.opengis.net/ogc\"" +
 " xmlns:gml=\"http://www.opengis.net/gml\"" +
 " xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"" +
 " xsi:schemaLocation=\"http://www.opengis.net/wfs" +
  " http://schemas.opengis.net/wfs/1.0.0/WFS-basic.xsd\">" +
 " <wfs:Query typeName=\"";
    postDataMETA2 = "\">" +
 "  <ogc:PropertyName>topp:id</ogc:PropertyName>" +
 "  <ogc:Filter>";
//" <ogc:BBOX>" +
//"       <ogc:PropertyName>topp:geom</ogc:PropertyName>" +
//"       <gml:Box srsName=\"http://www.opengis.net/gml/srs/epsg.xml#4327\">" +
//"          <gml:coordinates>";
    //postDataMETA3 = "</gml:coordinates>" +
//"       </gml:Box>" +
//"     </ogc:BBOX>" +
      postDataMETA3 = "  </ogc:Filter>" +
" </wfs:Query>" +
"</wfs:GetFeature>";
    FilterGeom = "";
    solidtocsv = "id, geom\n";
    
    radii = 1;
    ellipsoid = viewer.scene.globe.ellipsoid;
    userScale = 0;
    x = 15;y = 25;
    scale = 1;
    translate = [0, 0, 0];
    ENU = new Cesium.Matrix4();
    position = Cesium.Cartesian3.fromDegrees(127.1034,37.51283,0);
      //var currentRotation = new Cesium.Matrix3();
      var angle = 0.43;
      orientation  = new Cesium.Matrix4(Math.cos(angle),-Math.sin(angle),0,0,
                                   Math.sin(angle), Math.cos(angle),0,0,
                                  0,0,1,0,
                                 0,0,0,1);
    Cesium.Transforms.eastNorthUpToFixedFrame(position,ellipsoid,ENU);//matrix4
    //Cesium.Matrix4.getRotation(ENU, currentRotation);
    //Cesium.Matrix4.multiplyByPoint(orientation, ENU , ENU );


var camera = new Cesium.Camera(viewer.scene);
camera.position = Cesium.Cartesian3.fromDegrees(127.1034,37.51283,100);

    var loader = new Loader();
    var multiline = "-175.63079 16.30915,-177.486664697825 13.9501914264616,-175.85679 17.9422,-177.282592609464 16.0816284635521,-177.55091 17.72839,-177.282592609464 16.0816284635521,-183.61306 16.51536,-183.240265833169 14.9750578347137,-185.20355 16.06243,-183.240265833169 14.9750578347137,-184.73378 14.43959,-182.876548890339 13.427582542076,-187.28848 13.67394,-187.014579196154 12.8208255402221,-190.34641 12.62603,-190.528483175992 12.2354513174793,-190.95718 14.20906,-191.535482019786 12.9539070963458,-191.89404 13.87864,-191.535482019786 12.9539070963458,-194.695 12.69203,-193.541818318767 11.9281716812329,-194.695 10.77499,-193.541818318767 11.9281716812329,-191.595 10.77499,-192.882150720687 12.0621407206867,-191.595 11.92499,-192.423924983831 12.7539149838308,-183.895 11.92499,-181.403439059887 14.4165509401133,-183.895 4.22498999999999,-182.990115 3.32010499999998,-190.545 4.22498999999999,-191.481465 3.28852499999998,-190.545 7.37499,-191.481465 6.43852499999998,-192.41793 7.37499,-191.481465 6.43852499999998,-192.41793 1.97498999999999,-191.29293 3.09998999999999,-182.08523 1.97498999999999,-183.21023 3.09998999999999,-182.08523 11.78846,-182.990115 12.693345,-176.68523 11.78846,-175.984965 12.488725,-176.68523 -4.01114999999999,-175.885229134461 -3.9054283942552,-175.86987 -7.04221000000001,-174.892215703578 -7.59690789366519,-183.44143 -9.18540999999999,-180.8966438738 -16.5017206774449,-192.93943 -13.12993,-190.48882582479 -21.3738502202179,-195.50406 -13.60791,-195.806646543079 -24.9994074899097,-198.04666 -12.99277,-203.626542560212 -25.7536941650657,-206.27532 -7.51830000000001,-208.217456213441 -9.88363235635521,-209.71613 -4.06037000000001,-209.740412393723 -6.82521903082026,-212.43921 -6.70251999999999,-209.740412393723 -6.82521903082026,-210.96052 -8.42420999999999,-208.287223237008 -8.39683640406791,-215.62082 -14.0807,-206.540075679104 -21.1883234159114,-216.90453 -15.80815,-206.567995204557 -23.0654999420547,-221.00165 -21.99143,-220.648339142433 -24.5357535873557,-222.74943 -20.49024,-222.234600497864 -23.1975959750282,-224.31377 -23.45643,-224.283230940128 -23.6060516462771,-224.695 -23.14638,-224.600052758254 -23.3459834545161,-224.695 -23.39062,-224.600052758254 -23.3459834545161,-218.59256 -28.44649,-213.988903788445 -23.5506338524636,-217.10256 -30.0351,-207.968567816435 -23.0431639778568,-215.70792 -32.29307,-202.834369752435 -26.3281731143644,-214.11231 -37.19826,-200.35542427394 -33.8978920162899,-213.36939 -41.90901,-202.302771110335 -40.9429305098476,-213.28854 -46.46786,-204.07480571939 -46.8737924255181,-213.90807 -52.30219,-205.570634882198 -52.9273267729199,-214.14183 -57.62501,-212.664675882701 -59.1684594419669,-221.79501 -57.62501,-220.92002 -58.5,-221.79501 -58.72501,-220.92002 -59.6,-225.295 -58.72501,-223.72 -60.30001,-225.295 -61.87501,-223.72 -60.30001,-221.84501 -61.87501,-220.94502 -60.97502,-221.84501 -70.02501,-220.94502 -69.12502,-220.04503 -70.02501,-220.94502 -69.12502,-220.04503 -59.22501,-220.84503 -58.42501,-214.21436 -59.22501,-213.514489017629 -58.42501,-212.90311 -69.0021,-207.347092233108 -67.9312368617548,-211.50086 -74.55183,-206.899948112734 -73.6365208957271,-210.8581 -78.94544,-206.54148834471 -78.5631326717199,-210.73325 -82.9192,-206.471658384643 -83.0093635760692,-211.01461 -86.72907,-206.627161564886 -87.2264063988032,-211.9646 -92.92961,-208.70739385844 -93.8392332335854,-212.33936 -93.83455,-209.473405346409 -95.9266594033517,-213.09618 -94.47497,-211.915544306815 -96.8212701716974,-215.52959 -95.04502,-215.279391150703 -97.210015,-219.05174 -95.04502,-219.94851029147 -97.210015,-219.7207 -94.37606,-221.07284 -94.9361347262272,-219.7207 -92.94501,-221.07284 -94.29715,-222.42498 -92.94501,-221.07284 -94.29715,-222.42498 -94.20001,-220.637251422601 -95.9877385773993,-222.82497 -94.20001,-220.754405781194 -96.2705742188061,-222.82497 -99.37501,-220.451591811446 -97.0016318114465,-211.92 -99.37501,-208.635 -96.09001,-211.92 -102.11897,-208.635 -98.83397,-205.35 -102.11897,-208.635 -98.83397,-205.35 -93.80502,-208.467366184482 -90.6876538155181,-194.095 -93.80502,-192.44501 -92.15503,-194.095 -96.02501,-192.44501 -97.675,-194.9825 -96.02501,-192.88876 -98.11875,-194.9825 -102.62502,-191.938801394798 -99.5813213947978,-188.89502 -102.62502,-191.938801394798 -99.5813213947978,-188.89519 -96.37501,-191.938803606358 -99.4187063936418,-190.79502 -96.37501,-192.88876 -98.46875,-190.79502 -93.80502,-192.44501 -92.15503,-185.34502 -93.80502,-187.36003 -91.79001,-185.34502 -89.775,-187.36003 -91.79001,-187.82357 -89.775,-187.672592099456 -91.79001,-193.85837 -90.68444,-193.702939777335 -92.2418436047754,-197.60422 -90.86952,-197.783194157014 -92.3425835094946,-199.74434 -90.22813,-200.710009427347 -91.9134322534048,-201.38365 -88.70257,-204.113313611584 -90.5748384964952,-202.215 -86.6276,-206.646655184572 -87.4823589295025,-202.215 -71.59976,-207.202802003724 -71.2016225725617,-201.5415 -67.40789,-207.323229064383 -66.0948391662643,-199.24178 -59.62546,-206.471005538715 -57.1248953792989,-195.45908 -50.11907,-203.781827009353 -45.268178539961,-193.71484 -47.94759,-201.52172367297 -38.0086718704435,-191.31254 -46.82373,-193.11860489017 -38.9025388225021,-188.80446 -46.79673,-187.814077472643 -41.8275770384367,-186.51769 -47.77496,-184.1161980311 -44.2392101537171,-184.39972 -49.90842,-181.201851740412 -47.0668953169955,-178.48117 -57.36098,-179.17886296625 -50.398955342946,-175.88688 -52.27156,-179.17886296625 -50.398955342946,-173.12269 -47.89158,-179.255125279656 -48.9906836010321,-178.31425 -43.91919,-181.085207537807 -47.1933160325024,-184.1779 -38.43939,-188.212644756503 -41.6728023426096,-185.95264 -35.42392,-194.717443852926 -38.4068536008304,-186.24819 -33.05492,-200.564846194724 -32.9583165633695,-185.83462 -30.06856,-197.690487442414 -25.7684310003581,-184.02799 -27.17588,-190.365392582727 -21.2692338316675,-181.47953 -25.32318,-185.534323675864 -18.5598372435724,-178.41631 -23.83769,-181.538252412461 -16.7629297261153,-172.70041 -21.55717,-172.055732892151 -20.6058176053858,-172.69993 -32.22501,-171.722486990544 -31.2475230094565,-170.745 -32.22501,-171.722486990544 -31.2475230094565,-170.745 -22.62334,-171.722677634385 -22.7735313577095,-171.26567 -20.96867,-180.548144467303 -16.0273266190876,-164.86435 -19.07525,-166.654052820153 -12.5105189230193,-157.324 -17.19219,-158.554917201835 -11.3935440589429,-150.07754 -15.92128,-150.705223003682 -10.7093321386931,-143.7934 -15.50535,-140.506041239767 -10.3707895493567,-140.20514 -24.875,-137.0743417856 -17.7029250884917,-138.89763 -24.34992,-136.17209489515 -18.152223605532,-138.53838 -25.30348,-135.806420225128 -19.2935292593584,-134.3671 -23.74674,-135.806420225128 -19.2935292593584,-130.06821 -22.56611,-135.804480393364 -19.2897220787652,-130.33532 -21.58133,-137.108154047281 -17.5992645109906,-126.93825 -20.73952,-128.697233296673 -13.2437705378749,-123.52128 -19.98232,-119.857537309303 -14.3694465018581,-123.32267 -20.98198,-120.18879536639 -16.2903572521508,-119.56582 -20.2327,-120.18879536639 -16.2903572521508,-114.50827 -19.64035,-119.666544990687 -15.5726322324687,-114.63997 -18.5363,-122.244770145823 -12.3653396168547,-107.06147 -17.86236,-109.875048794155 -14.9375476520726,-106.28136 -11.77501,-109.875048794155 -14.9375476520726,-109.345 -11.77501,-112.629782782136 -15.0597927821365,-109.345 -4.82138,-115.868215290484 -11.8786790077209,-116.2533 -5.36559,-115.868215290484 -11.8786790077209,-120.79369 -5.54501999999999,-120.660376994348 -12.2950324692887,-130.35899 -5.54499000000001,-131.382953769765 -13.5715758825881,-131.41767 -5.27041,-134.747177285853 -11.2574685191279,-132.21899 -4.50683000000001,-134.45037780092 -5.89260509150371,-132.545 -3.46027000000001,-134.469365743626 -3.75305766904336,-132.545 -1.67250999999999,-133.395 -0.822509999999994,-123.395 -1.67250999999999,-126.01875 0.951240000000013,-123.395 3.57499000000001,-126.01875 0.951240000000013,-127.245 3.57499000000001,-128.42 2.39999000000002,-127.245 5.59998999999999,-128.42 4.42498999999999,-129.595 5.59998999999999,-128.42 4.42498999999999,-129.595 0.0274900000000002,-128.745 -0.822509999999994,-133.41501 0.0274900000000002,-134.996435892332 -1.55393589233181,-133.41501 11.82499,-135.95501 9.28499000000001,-138.49501 11.82499,-135.95501 9.28499000000001,-138.49501 3.67501999999999,-135.95501 6.21502000000001,-137.82171 3.67501999999999,-135.924962159481 6.18497215948078,-136.68517 -0.329689999999999,-135.059537656943 -0.0342700040325212,-136.41418 -3.58716000000001,-134.462001463134 -3.79084212156731,-136.80822 -4.9032,-134.088341720553 -7.25740078781783,-138.01539 -5.46387,-136.289951672237 -13.2700161040058,-161.37346 -5.47020000000001,-161.298318515377 -11.7312971370151,-165.2437 -5.56206,-164.88018044698 -12.2149918822937,-169.24613 -5.90486999999999,-168.407776677343 -12.8414595133768,-174.3061 -6.69607999999999,-174.89549737756 -7.60269183806291,-175.2847 -3.05817999999999,-175.984965 -3.15072123998497,-175.2847 14.63625,-176.134435653829 15.4045679889539,-171.00666 15.06787,-171.065233409476 15.9147987843227,-166.695 15.22984,-165.859564991415 16.0972478712592,-166.695 10.07499,-165.45 11.31999,-166.105 10.07499,-165.155 11.02499,-166.105 6.27499,-165.105 7.27499,-161.4382 6.27499,-162.4382 7.27499,-161.4382 8.27499,-162.4382 7.27499,-164.205 8.27499,-165.155 7.32499000000001,-164.205 16.98001,-165.45 15.699149538446,-170.82111 16.79211,-170.766004233936 15.9354222975992,-224.600052758254 -23.3459834545161,-224.283230940128 -23.6060516462771,-224.283230940128 -23.6060516462771,-222.234600497864 -23.1975959750282,-190.528483175992 12.2354513174793,-187.014579196154 12.8208255402221,-190.528483175992 12.2354513174793,-191.544555112149 12.9325024078253,-172.055732892151 -20.6058176053858,-180.783495233362 -16.4632506735389,-172.055732892151 -20.6058176053858,-171.722677634385 -22.7735313577095,-175.984965 -3.15072123998497,-175.885229134461 -3.9054283942552,-175.984965 -3.15072123998497,-175.984965 12.488725,-175.984965 12.488725,-177.448350257937 13.9521102579366,-213.514489017629 -58.42501,-220.84503 -58.42501,-213.514489017629 -58.42501,-212.664675882701 -59.1684594419669,-220.84503 -58.42501,-220.92002 -58.5,-174.892215703578 -7.59690789366519,-175.885229134461 -3.9054283942552,-174.892215703578 -7.59690789366519,-174.89549737756 -7.60269183806291,-174.89549737756 -7.60269183806291,-173.498138688556 -13.9869721779446,-192.423924983831 12.7539149838308,-192.882150720687 12.0621407206867,-192.423924983831 12.7539149838308,-191.544555112149 12.9325024078253,-165.859564991415 16.0972478712592,-170.766004233936 15.9354222975992,-165.859564991415 16.0972478712592,-165.45 15.699149538446,-171.065233409476 15.9147987843227,-176.134435653829 15.4045679889539,-171.065233409476 15.9147987843227,-170.766004233936 15.9354222975992,-176.134435653829 15.4045679889539,-177.448350257937 13.9521102579366,-133.395 -0.822509999999994,-134.543367985659 -1.97087798565872,-133.395 -0.822509999999994,-128.745 -0.822509999999994,-128.745 -0.822509999999994,-126.97125 0.951240000000013,-220.92002 -58.5,-220.92002 -59.6,-220.92002 -59.6,-221.62003 -60.30001,-187.014579196154 12.8208255402221,-182.876548890339 13.427582542076,-220.94502 -69.12502,-220.94502 -60.97502,-220.94502 -60.97502,-221.62003 -60.30001,-182.990115 12.693345,-182.990115 3.32010499999998,-182.990115 12.693345,-181.328411212665 14.3550487873351,-182.990115 3.32010499999998,-183.21023 3.09998999999999,-191.481465 6.43852499999998,-191.481465 3.28852499999998,-191.481465 3.28852499999998,-191.29293 3.09998999999999,-165.155 11.02499,-165.45 11.31999,-165.155 11.02499,-165.155 7.32499000000001,-165.155 7.32499000000001,-165.105 7.27499,-171.722486990544 -31.2475230094565,-171.722677634385 -22.7735313577095,-191.535482019786 12.9539070963458,-191.544555112149 12.9325024078253,-162.4382 7.27499,-165.105 7.27499,-183.21023 3.09998999999999,-191.29293 3.09998999999999,-193.541818318767 11.9281716812329,-192.882150720687 12.0621407206867,-128.42 2.39999000000002,-126.97125 0.951240000000013,-128.42 2.39999000000002,-128.42 4.42498999999999,-165.45 11.31999,-165.45 15.699149538446,-221.07284 -94.29715,-221.07284 -94.9361347262272,-221.07284 -94.9361347262272,-220.637251422601 -95.9877385773993,-197.783194157014 -92.3425835094946,-193.702939777335 -92.2418436047754,-197.783194157014 -92.3425835094946,-200.710009427347 -91.9134322534048,-182.876548890339 13.427582542076,-182.191971145607 14.3384329876464,-212.664675882701 -59.1684594419669,-206.768465950355 -58.9046326313581,-193.702939777335 -92.2418436047754,-192.44501 -92.1475911708846,-223.72 -60.30001,-221.62003 -60.30001,-134.996435892332 -1.55393589233181,-134.543367985659 -1.97087798565872,-134.996435892332 -1.55393589233181,-135.059537656943 -0.0342700040325212,-183.240265833169 14.9750578347137,-182.191971145607 14.3384329876464,-135.059537656943 -0.0342700040325212,-135.924962159481 6.18497215948078,-192.44501 -97.675,-192.44501 -92.15503,-192.44501 -97.675,-192.88876 -98.11875,-192.44501 -92.15503,-192.44501 -92.1475911708846,-192.44501 -92.1475911708846,-187.672592099456 -91.79001,-177.282592609464 16.0816284635521,-178.296234127505 14.655439183236,-220.648339142433 -24.5357535873557,-213.988903788445 -23.5506338524636,-220.648339142433 -24.5357535873557,-222.234600497864 -23.1975959750282,-220.637251422601 -95.9877385773993,-220.754405781194 -96.2705742188061,-200.710009427347 -91.9134322534048,-204.113313611584 -90.5748384964952,-134.469365743626 -3.75305766904336,-134.462001463134 -3.79084212156731,-134.469365743626 -3.75305766904336,-134.543367985659 -1.97087798565872,-134.462001463134 -3.79084212156731,-134.45037780092 -5.89260509150371,-209.740412393723 -6.82521903082026,-208.287223237008 -8.39683640406791,-187.672592099456 -91.79001,-187.36003 -91.79001,-208.287223237008 -8.39683640406791,-208.217456213441 -9.88363235635521,-220.754405781194 -96.2705742188061,-220.451591811446 -97.0016318114465,-192.88876 -98.11875,-192.88876 -98.46875,-192.88876 -98.46875,-191.938803606358 -99.4187063936418,-177.486664697825 13.9501914264616,-177.448350257937 13.9521102579366,-177.486664697825 13.9501914264616,-178.296234127505 14.655439183236,-219.94851029147 -97.210015,-215.279391150703 -97.210015,-219.94851029147 -97.210015,-220.451591811446 -97.0016318114465,-215.279391150703 -97.210015,-211.915544306815 -96.8212701716974,-182.191971145607 14.3384329876464,-181.403439059887 14.4165509401133,-181.403439059887 14.4165509401133,-181.328411212665 14.3550487873351,-135.924962159481 6.18497215948078,-135.95501 6.21502000000001,-135.95501 6.21502000000001,-135.95501 9.28499000000001,-134.45037780092 -5.89260509150371,-134.088341720553 -7.25740078781783,-211.915544306815 -96.8212701716974,-209.473405346409 -95.9266594033517,-181.328411212665 14.3550487873351,-178.296234127505 14.655439183236,-126.97125 0.951240000000013,-126.01875 0.951240000000013,-191.938803606358 -99.4187063936418,-191.938801394798 -99.5813213947978,-208.217456213441 -9.88363235635521,-206.540075679104 -21.1883234159114,-208.467366184482 -90.6876538155181,-208.70739385844 -93.8392332335854,-208.467366184482 -90.6876538155181,-206.474727448516 -88.9770574434548,-109.875048794155 -14.9375476520726,-112.629782782136 -15.0597927821365,-204.113313611584 -90.5748384964952,-206.474727448516 -88.9770574434548,-134.088341720553 -7.25740078781783,-134.747177285853 -11.2574685191279,-112.629782782136 -15.0597927821365,-115.979649059743 -11.9946034674136,-208.635 -96.09001,-209.068752579663 -95.6562574203369,-208.635 -96.09001,-208.635 -98.83397,-208.70739385844 -93.8392332335854,-209.068752579663 -95.6562574203369,-209.473405346409 -95.9266594033517,-209.068752579663 -95.6562574203369,-179.17886296625 -50.398955342946,-179.255125279656 -48.9906836010321,-120.18879536639 -16.2903572521508,-119.666544990687 -15.5726322324687,-184.1161980311 -44.2392101537171,-187.814077472643 -41.8275770384367,-184.1161980311 -44.2392101537171,-181.201851740412 -47.0668953169955,-206.471658384643 -83.0093635760692,-206.54148834471 -78.5631326717199,-206.471658384643 -83.0093635760692,-206.627161564886 -87.2264063988032,-181.201851740412 -47.0668953169955,-181.085207537807 -47.1933160325024,-181.085207537807 -47.1933160325024,-179.255125279656 -48.9906836010321,-206.54148834471 -78.5631326717199,-206.899948112734 -73.6365208957271,-206.627161564886 -87.2264063988032,-206.646655184572 -87.4823589295025,-206.646655184572 -87.4823589295025,-206.474727448516 -88.9770574434548,-119.666544990687 -15.5726322324687,-119.857537309303 -14.3694465018581,-135.806420225128 -19.2935292593584,-135.804480393364 -19.2897220787652,-135.804480393364 -19.2897220787652,-136.17209489515 -18.152223605532,-206.899948112734 -73.6365208957271,-207.202802003724 -71.2016225725617,-119.857537309303 -14.3694465018581,-122.413986374331 -12.5559404123281,-136.17209489515 -18.152223605532,-137.0743417856 -17.7029250884917,-140.506041239767 -10.3707895493567,-150.705223003682 -10.7093321386931,-140.506041239767 -10.3707895493567,-136.289951672237 -13.2700161040058,-187.814077472643 -41.8275770384367,-188.212644756503 -41.6728023426096,-207.202802003724 -71.2016225725617,-207.347092233108 -67.9312368617548,-188.212644756503 -41.6728023426096,-193.11860489017 -38.9025388225021,-150.705223003682 -10.7093321386931,-158.554917201835 -11.3935440589429,-137.0743417856 -17.7029250884917,-137.108154047281 -17.5992645109906,-137.108154047281 -17.5992645109906,-135.100142484844 -13.7523293280115,-207.347092233108 -67.9312368617548,-207.323229064383 -66.0948391662643,-207.323229064383 -66.0948391662643,-206.768465950355 -58.9046326313581,-158.554917201835 -11.3935440589429,-161.298318515377 -11.7312971370151,-161.298318515377 -11.7312971370151,-164.88018044698 -12.2149918822937,-115.868215290484 -11.8786790077209,-115.979649059743 -11.9946034674136,-134.747177285853 -11.2574685191279,-134.538689812878 -13.554443696348,-115.979649059743 -11.9946034674136,-120.660376994348 -12.2950324692887,-164.88018044698 -12.2149918822937,-166.654052820153 -12.5105189230193,-213.988903788445 -23.5506338524636,-207.968567816435 -23.0431639778568,-120.660376994348 -12.2950324692887,-122.244770145823 -12.3653396168547,-166.654052820153 -12.5105189230193,-168.407776677343 -12.8414595133768,-122.244770145823 -12.3653396168547,-122.413986374331 -12.5559404123281,-168.407776677343 -12.8414595133768,-173.498138688556 -13.9869721779446,-122.413986374331 -12.5559404123281,-128.697233296673 -13.2437705378749,-173.498138688556 -13.9869721779446,-180.548144467303 -16.0273266190876,-180.548144467303 -16.0273266190876,-180.783495233362 -16.4632506735389,-206.768465950355 -58.9046326313581,-206.471005538715 -57.1248953792989,-206.471005538715 -57.1248953792989,-205.570634882198 -52.9273267729199,-128.697233296673 -13.2437705378749,-131.382953769765 -13.5715758825881,-180.783495233362 -16.4632506735389,-180.8966438738 -16.5017206774449,-181.538252412461 -16.7629297261153,-185.534323675864 -18.5598372435724,-181.538252412461 -16.7629297261153,-180.8966438738 -16.5017206774449,-136.289951672237 -13.2700161040058,-135.100142484844 -13.7523293280115,-185.534323675864 -18.5598372435724,-190.365392582727 -21.2692338316675,-193.11860489017 -38.9025388225021,-194.717443852926 -38.4068536008304,-131.382953769765 -13.5715758825881,-134.538689812878 -13.554443696348,-205.570634882198 -52.9273267729199,-204.07480571939 -46.8737924255181,-190.365392582727 -21.2692338316675,-190.48882582479 -21.3738502202179,-190.48882582479 -21.3738502202179,-195.806646543079 -24.9994074899097,-135.100142484844 -13.7523293280115,-134.538689812878 -13.554443696348,-194.717443852926 -38.4068536008304,-200.14172100774 -35.4114274956514,-204.07480571939 -46.8737924255181,-203.781827009353 -45.268178539961,-203.781827009353 -45.268178539961,-202.302771110335 -40.9429305098476,-202.302771110335 -40.9429305098476,-201.52172367297 -38.0086718704435,-195.806646543079 -24.9994074899097,-197.690487442414 -25.7684310003581,-207.968567816435 -23.0431639778568,-206.567995204557 -23.0654999420547,-206.540075679104 -21.1883234159114,-206.210672361868 -23.0808363709561,-201.52172367297 -38.0086718704435,-200.14172100774 -35.4114274956514,-197.690487442414 -25.7684310003581,-201.002381664772 -28.0240555547118,-206.567995204557 -23.0654999420547,-206.210672361868 -23.0808363709561,-206.210672361868 -23.0808363709561,-203.626542560212 -25.7536941650657,-203.626542560212 -25.7536941650657,-202.834369752435 -26.3281731143644,-200.14172100774 -35.4114274956514,-200.35542427394 -33.8978920162899,-202.834369752435 -26.3281731143644,-201.002381664772 -28.0240555547118,-200.35542427394 -33.8978920162899,-200.564846194724 -32.9583165633695,-200.564846194724 -32.9583165633695,-201.002381664772 -28.0240555547118";
    var approximate = "-224.600052758254 -23.3459834545161,-224.283230940128 -23.6060516462771,-224.283230940128 -23.6060516462771,-222.234600497864 -23.1975959750282,-190.528483175992 12.2354513174793,-187.014579196154 12.8208255402221,-190.528483175992 12.2354513174793,-191.544555112149 12.9325024078253,-172.055732892151 -20.6058176053858,-180.783495233362 -16.4632506735389,-172.055732892151 -20.6058176053858,-171.722677634385 -22.7735313577095,-175.984965 -3.15072123998497,-175.885229134461 -3.9054283942552,-175.984965 -3.15072123998497,-175.984965 12.488725,-175.984965 12.488725,-177.448350257937 13.9521102579366,-213.514489017629 -58.42501,-220.84503 -58.42501,-213.514489017629 -58.42501,-212.664675882701 -59.1684594419669,-220.84503 -58.42501,-220.92002 -58.5,-174.892215703578 -7.59690789366519,-175.885229134461 -3.9054283942552,-174.892215703578 -7.59690789366519,-174.89549737756 -7.60269183806291,-174.89549737756 -7.60269183806291,-173.498138688556 -13.9869721779446,-192.423924983831 12.7539149838308,-192.882150720687 12.0621407206867,-192.423924983831 12.7539149838308,-191.544555112149 12.9325024078253,-165.859564991415 16.0972478712592,-170.766004233936 15.9354222975992,-165.859564991415 16.0972478712592,-165.45 15.699149538446,-171.065233409476 15.9147987843227,-176.134435653829 15.4045679889539,-171.065233409476 15.9147987843227,-170.766004233936 15.9354222975992,-176.134435653829 15.4045679889539,-177.448350257937 13.9521102579366,-133.395 -0.822509999999994,-134.543367985659 -1.97087798565872,-133.395 -0.822509999999994,-128.745 -0.822509999999994,-128.745 -0.822509999999994,-126.97125 0.951240000000013,-220.92002 -58.5,-220.92002 -59.6,-220.92002 -59.6,-221.62003 -60.30001,-187.014579196154 12.8208255402221,-182.876548890339 13.427582542076,-220.94502 -69.12502,-220.94502 -60.97502,-220.94502 -60.97502,-221.62003 -60.30001,-182.990115 12.693345,-182.990115 3.32010499999998,-182.990115 12.693345,-181.328411212665 14.3550487873351,-182.990115 3.32010499999998,-183.21023 3.09998999999999,-191.481465 6.43852499999998,-191.481465 3.28852499999998,-191.481465 3.28852499999998,-191.29293 3.09998999999999,-165.155 11.02499,-165.45 11.31999,-165.155 11.02499,-165.155 7.32499000000001,-165.155 7.32499000000001,-165.105 7.27499,-171.722486990544 -31.2475230094565,-171.722677634385 -22.7735313577095,-191.535482019786 12.9539070963458,-191.544555112149 12.9325024078253,-162.4382 7.27499,-165.105 7.27499,-183.21023 3.09998999999999,-191.29293 3.09998999999999,-193.541818318767 11.9281716812329,-192.882150720687 12.0621407206867,-128.42 2.39999000000002,-126.97125 0.951240000000013,-128.42 2.39999000000002,-128.42 4.42498999999999,-165.45 11.31999,-165.45 15.699149538446,-221.07284 -94.29715,-221.07284 -94.9361347262272,-221.07284 -94.9361347262272,-220.637251422601 -95.9877385773993,-197.783194157014 -92.3425835094946,-193.702939777335 -92.2418436047754,-197.783194157014 -92.3425835094946,-200.710009427347 -91.9134322534048,-182.876548890339 13.427582542076,-182.191971145607 14.3384329876464,-212.664675882701 -59.1684594419669,-206.768465950355 -58.9046326313581,-193.702939777335 -92.2418436047754,-192.44501 -92.1475911708846,-223.72 -60.30001,-221.62003 -60.30001,-134.996435892332 -1.55393589233181,-134.543367985659 -1.97087798565872,-134.996435892332 -1.55393589233181,-135.059537656943 -0.0342700040325212,-183.240265833169 14.9750578347137,-182.191971145607 14.3384329876464,-135.059537656943 -0.0342700040325212,-135.924962159481 6.18497215948078,-192.44501 -97.675,-192.44501 -92.15503,-192.44501 -97.675,-192.88876 -98.11875,-192.44501 -92.15503,-192.44501 -92.1475911708846,-192.44501 -92.1475911708846,-187.672592099456 -91.79001,-177.282592609464 16.0816284635521,-178.296234127505 14.655439183236,-220.648339142433 -24.5357535873557,-213.988903788445 -23.5506338524636,-220.648339142433 -24.5357535873557,-222.234600497864 -23.1975959750282,-220.637251422601 -95.9877385773993,-220.754405781194 -96.2705742188061,-200.710009427347 -91.9134322534048,-204.113313611584 -90.5748384964952,-134.469365743626 -3.75305766904336,-134.462001463134 -3.79084212156731,-134.469365743626 -3.75305766904336,-134.543367985659 -1.97087798565872,-134.462001463134 -3.79084212156731,-134.45037780092 -5.89260509150371,-209.740412393723 -6.82521903082026,-208.287223237008 -8.39683640406791,-187.672592099456 -91.79001,-187.36003 -91.79001,-208.287223237008 -8.39683640406791,-208.217456213441 -9.88363235635521,-220.754405781194 -96.2705742188061,-220.451591811446 -97.0016318114465,-192.88876 -98.11875,-192.88876 -98.46875,-192.88876 -98.46875,-191.938803606358 -99.4187063936418,-177.486664697825 13.9501914264616,-177.448350257937 13.9521102579366,-177.486664697825 13.9501914264616,-178.296234127505 14.655439183236,-219.94851029147 -97.210015,-215.279391150703 -97.210015,-219.94851029147 -97.210015,-220.451591811446 -97.0016318114465,-215.279391150703 -97.210015,-211.915544306815 -96.8212701716974,-182.191971145607 14.3384329876464,-181.403439059887 14.4165509401133,-181.403439059887 14.4165509401133,-181.328411212665 14.3550487873351,-135.924962159481 6.18497215948078,-135.95501 6.21502000000001,-135.95501 6.21502000000001,-135.95501 9.28499000000001,-134.45037780092 -5.89260509150371,-134.088341720553 -7.25740078781783,-211.915544306815 -96.8212701716974,-209.473405346409 -95.9266594033517,-181.328411212665 14.3550487873351,-178.296234127505 14.655439183236,-126.97125 0.951240000000013,-126.01875 0.951240000000013,-191.938803606358 -99.4187063936418,-191.938801394798 -99.5813213947978,-208.217456213441 -9.88363235635521,-206.540075679104 -21.1883234159114,-208.467366184482 -90.6876538155181,-208.70739385844 -93.8392332335854,-208.467366184482 -90.6876538155181,-206.474727448516 -88.9770574434548,-109.875048794155 -14.9375476520726,-112.629782782136 -15.0597927821365,-204.113313611584 -90.5748384964952,-206.474727448516 -88.9770574434548,-134.088341720553 -7.25740078781783,-134.747177285853 -11.2574685191279,-112.629782782136 -15.0597927821365,-115.979649059743 -11.9946034674136,-208.635 -96.09001,-209.068752579663 -95.6562574203369,-208.635 -96.09001,-208.635 -98.83397,-208.70739385844 -93.8392332335854,-209.068752579663 -95.6562574203369,-209.473405346409 -95.9266594033517,-209.068752579663 -95.6562574203369,-179.17886296625 -50.398955342946,-179.255125279656 -48.9906836010321,-120.18879536639 -16.2903572521508,-119.666544990687 -15.5726322324687,-184.1161980311 -44.2392101537171,-187.814077472643 -41.8275770384367,-184.1161980311 -44.2392101537171,-181.201851740412 -47.0668953169955,-206.471658384643 -83.0093635760692,-206.54148834471 -78.5631326717199,-206.471658384643 -83.0093635760692,-206.627161564886 -87.2264063988032,-181.201851740412 -47.0668953169955,-181.085207537807 -47.1933160325024,-181.085207537807 -47.1933160325024,-179.255125279656 -48.9906836010321,-206.54148834471 -78.5631326717199,-206.899948112734 -73.6365208957271,-206.627161564886 -87.2264063988032,-206.646655184572 -87.4823589295025,-206.646655184572 -87.4823589295025,-206.474727448516 -88.9770574434548,-119.666544990687 -15.5726322324687,-119.857537309303 -14.3694465018581,-135.806420225128 -19.2935292593584,-135.804480393364 -19.2897220787652,-135.804480393364 -19.2897220787652,-136.17209489515 -18.152223605532,-206.899948112734 -73.6365208957271,-207.202802003724 -71.2016225725617,-119.857537309303 -14.3694465018581,-122.413986374331 -12.5559404123281,-136.17209489515 -18.152223605532,-137.0743417856 -17.7029250884917,-140.506041239767 -10.3707895493567,-150.705223003682 -10.7093321386931,-140.506041239767 -10.3707895493567,-136.289951672237 -13.2700161040058,-187.814077472643 -41.8275770384367,-188.212644756503 -41.6728023426096,-207.202802003724 -71.2016225725617,-207.347092233108 -67.9312368617548,-188.212644756503 -41.6728023426096,-193.11860489017 -38.9025388225021,-150.705223003682 -10.7093321386931,-158.554917201835 -11.3935440589429,-137.0743417856 -17.7029250884917,-137.108154047281 -17.5992645109906,-137.108154047281 -17.5992645109906,-135.100142484844 -13.7523293280115,-207.347092233108 -67.9312368617548,-207.323229064383 -66.0948391662643,-207.323229064383 -66.0948391662643,-206.768465950355 -58.9046326313581,-158.554917201835 -11.3935440589429,-161.298318515377 -11.7312971370151,-161.298318515377 -11.7312971370151,-164.88018044698 -12.2149918822937,-115.868215290484 -11.8786790077209,-115.979649059743 -11.9946034674136,-134.747177285853 -11.2574685191279,-134.538689812878 -13.554443696348,-115.979649059743 -11.9946034674136,-120.660376994348 -12.2950324692887,-164.88018044698 -12.2149918822937,-166.654052820153 -12.5105189230193,-213.988903788445 -23.5506338524636,-207.968567816435 -23.0431639778568,-120.660376994348 -12.2950324692887,-122.244770145823 -12.3653396168547,-166.654052820153 -12.5105189230193,-168.407776677343 -12.8414595133768,-122.244770145823 -12.3653396168547,-122.413986374331 -12.5559404123281,-168.407776677343 -12.8414595133768,-173.498138688556 -13.9869721779446,-122.413986374331 -12.5559404123281,-128.697233296673 -13.2437705378749,-173.498138688556 -13.9869721779446,-180.548144467303 -16.0273266190876,-180.548144467303 -16.0273266190876,-180.783495233362 -16.4632506735389,-206.768465950355 -58.9046326313581,-206.471005538715 -57.1248953792989,-206.471005538715 -57.1248953792989,-205.570634882198 -52.9273267729199,-128.697233296673 -13.2437705378749,-131.382953769765 -13.5715758825881,-180.783495233362 -16.4632506735389,-180.8966438738 -16.5017206774449,-181.538252412461 -16.7629297261153,-185.534323675864 -18.5598372435724,-181.538252412461 -16.7629297261153,-180.8966438738 -16.5017206774449,-136.289951672237 -13.2700161040058,-135.100142484844 -13.7523293280115,-185.534323675864 -18.5598372435724,-190.365392582727 -21.2692338316675,-193.11860489017 -38.9025388225021,-194.717443852926 -38.4068536008304,-131.382953769765 -13.5715758825881,-134.538689812878 -13.554443696348,-205.570634882198 -52.9273267729199,-204.07480571939 -46.8737924255181,-190.365392582727 -21.2692338316675,-190.48882582479 -21.3738502202179,-190.48882582479 -21.3738502202179,-195.806646543079 -24.9994074899097,-135.100142484844 -13.7523293280115,-134.538689812878 -13.554443696348,-194.717443852926 -38.4068536008304,-200.14172100774 -35.4114274956514,-204.07480571939 -46.8737924255181,-203.781827009353 -45.268178539961,-203.781827009353 -45.268178539961,-202.302771110335 -40.9429305098476,-202.302771110335 -40.9429305098476,-201.52172367297 -38.0086718704435,-195.806646543079 -24.9994074899097,-197.690487442414 -25.7684310003581,-207.968567816435 -23.0431639778568,-206.567995204557 -23.0654999420547,-206.540075679104 -21.1883234159114,-206.210672361868 -23.0808363709561,-201.52172367297 -38.0086718704435,-200.14172100774 -35.4114274956514,-197.690487442414 -25.7684310003581,-201.002381664772 -28.0240555547118,-206.567995204557 -23.0654999420547,-206.210672361868 -23.0808363709561,-206.210672361868 -23.0808363709561,-203.626542560212 -25.7536941650657,-203.626542560212 -25.7536941650657,-202.834369752435 -26.3281731143644,-200.14172100774 -35.4114274956514,-200.35542427394 -33.8978920162899,-202.834369752435 -26.3281731143644,-201.002381664772 -28.0240555547118,-200.35542427394 -33.8978920162899,-200.564846194724 -32.9583165633695,-200.564846194724 -32.9583165633695,-201.002381664772 -28.0240555547118";
    var roomapproximate = "-138.36854 17.90549,-140.94904 15.32499,-138.36854 17.90549,-134.74753 17.90549,-137.37151 12.89299,-138.51704 12.89299,-138.51704 12.89299,-140.94904 15.32499,-154.240632665296 13.62935,-156.77939 13.62935,-154.240632665296 13.62935,-153.521887665279 12.9106,-156.77939 13.62935,-158.481615 15.331575,-153.521887665279 12.9106,-144.82192 12.9106,-144.82192 12.9106,-144.44503 13.28749,-159.4291 8.08409,-159.4291 14.38409,-159.4291 14.38409,-158.481615 15.331575,-144.44503 13.28749,-144.44503 14.17499,-144.44503 14.17499,-143.29503 15.32499,-158.481615 15.868405,-158.481615 15.331575,-140.94904 15.32499,-143.29503 15.32499";
    var simpleroom = "-201.820958930378 -71.6312089303777,-197.848985202061 -68.2464697225599,-197.848985202061 -68.2464697225599,-191.103658689164 -63.206053194488,-187.988495154361 -73.5817551543612,-187.750818533768 -69.1827118344218,-187.750818533768 -69.1827118344218,-187.58569847 -67.4791984700001,-187.58569847 -67.4791984700001,-191.103658689164 -63.206053194488,-189.977140406813 -52.6806124159639,-189.976706966723 -52.7065997965716,-189.976706966723 -52.7065997965716,-189.947269470373 -52.8243763635719,-189.947269470373 -52.8243763635719,-189.919763275701 -53.3476534523465,-189.919763275701 -53.3476534523465,-189.666327491869 -54.5881700684697,-189.666327491869 -54.5881700684697,-189.226219910508 -57.5763001790738,-189.226219910508 -57.5763001790738,-190.458365894876 -60.8938145755564,-190.458365894876 -60.8938145755564,-190.930715449489 -62.5002299303263,-190.930715449489 -62.5002299303263,-191.103658689164 -63.206053194488";
    function drawSolid(envelope) {
      Gaia = [];
      var coordinate = envelope.split(" ");
      var min = coordinate[0].split(",");
      min[0] *= 1;min[1] *= 1;min[2] *= 1;

      var max = coordinate[1].split(",");
      max[0] *= 1;max[1] *= 1;max[2] *= 1;

      var points = [];
      points.push(min);
      points.push([min[0], max[1], min[2]]);
      points.push([min[0], max[1], max[2]]);
      points.push([min[0], min[1], max[2]]);
      points.push([max[0], min[1] ,max[2]]);
      points.push([max[0], min[1], min[2]]);
      points.push([max[0], max[1], min[2]]);
      points.push(max);

     createPolygonforbbox(points[0].concat(points[1]).concat(points[2]).concat(points[3]));
     createPolygonforbbox(points[4].concat(points[5]).concat(points[6]).concat(points[7]));
     createPolygonforbbox(points[6].concat(points[7]).concat(points[2]).concat(points[1]));
     createPolygonforbbox(points[0].concat(points[5]).concat(points[4]).concat(points[3]));
     createPolygonforbbox(points[0].concat(points[1]).concat(points[6]).concat(points[5]));
     createPolygonforbbox(points[2].concat(points[7]).concat(points[4]).concat(points[3]));

       showInCesium(Gaia,[]);
    }
    function drawPolygon(envelope) {
      Gaia = [];
      var coordinate = envelope.split(" ");
      var poslist = [];
      for(var i = 0; i < coordinate.length; i++) {
        var intarray = coordinate[i].split(",");
        intarray[0] *= 1;intarray[1] *= 1;intarray[2] *= 1;
        poslist = poslist.concat(intarray);
      }
      createPolygonforbbox(poslist);
      showInCesium(Gaia,[]);
    }
    function drawPolyline(envelope) {
      var coordinate = envelope.split(" ");
      var poslist = [];
      for(var i = 0; i < coordinate.length; i++) {
        var intarray = coordinate[i].split(",");
        intarray[0] *= 1;intarray[1] *= 1;intarray[2] *= 1;
        poslist = poslist.concat(intarray);
      }
      viewer.entities.add({
            polyline : {
                positions : toCartesian3(poslist),
                width : 5,
                material : Cesium.Color.RED
            }
        });
      viewer.zoomTo(viewer.entities);
    }
    function drawMultiLine(lines) {
      var coordinate = lines.split(",");
      var poslist = [];
      for(var i = 0; i < coordinate.length; i += 2) {
        var intarray = coordinate[i].split(" ");
        intarray[0] *= 1;intarray[1] *= 1;//intarray[2] *= 1;
        poslist[0] = intarray[0];poslist[1] = intarray[1];poslist[2] = 30;
        intarray = coordinate[i + 1].split(" ");
        intarray[0] *= 1;intarray[1] *= 1;//intarray[2] *= 1;
        poslist = poslist.concat(intarray);poslist.push(30);
        transformCoordinates(poslist);
        viewer.entities.add({
            polyline : {
                positions : toCartesian3(poslist),
                width : 5,
                material : Cesium.Color.RED
            }
        });
        poslist = [];
      }
      
      viewer.zoomTo(viewer.entities);
    }
    function requestWFS() {

      var qtype = document.getElementById("qtype").value; //"topp:gaia";
      //document.getElementById("qtype").value;
       //"127.10156397,37.46185285,-100 127.10226404,37.46227915,100";

      var request = postDataMETA1 + qtype + postDataMETA2 + FilterGeom + postDataMETA3;
      var url = document.getElementById("url").value;
/*
      $.ajax({
          type: 'POST',
          url: 'http://127.0.0.1:9090/geoserver/wfs',
          crossDomain: true,
          data: result,
          dataType: 'json',
          success: function(responseData, textStatus, jqXHR) {
              var value = responseData;
              console.log(value);
          },
          error: function (responseData, textStatus, errorThrown) {
              alert('POST failed.');
          }
      });
      */

      var req = new XMLHttpRequest();
      req.open("POST", url, true);
      //req.setRequestHeader('User-Agent', 'XMLHTTP/1.0');
      //req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
      //var qtype = document.getElementById("qtype").value
      //var envelope = document.getElementById("box").value

      idList = [];
      req.onreadystatechange = function () {
        if (this.readyState == 4 && this.status == 200) {
          var response = this.responseText;
          if(response != undefined) {
            var responseJSON = JSON.parse(response);

            var features = responseJSON.features;
            var length = features.length;
            var fid = "";
            for (k in features) {
                var f = features[k];
                var id = f.properties.id;
                idList.push(id);
                fid += id + "\r\n";
            }
            $("#content").text("number of feature : " + length + "\r\nfeatures : " + fid);
            $( "#dialog" ).dialog();

            for(id in idList) {
              var polygons = HilightCell[ idList[id] ];
              for(p in polygons) {
                var attributes = viewer.scene.primitives._primitives[1].getGeometryInstanceAttributes( polygons[p] );
                attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.YELLOW.withAlpha(1));
              }
            }
          }

          /*
          var parser = new DOMParser();
          var xmlDoc = parser.parseFromString(response, "text/xml");

          var idTags = document.getElementsByTagName("id");

          var i;
          for (i = 0; i < idTags.length; i++) {
              var id = idTags[i].nodeValue;
              idList.push(id);
          }
          console.log(idList);
          */
        }
      }
      req.send(request);
    }

    function clearHighLight() {
      for(id in idList) {
        var polygons = HilightCell[ idList[id] ];
        for(p in polygons) {
          var attributes = viewer.scene.primitives._primitives[1].getGeometryInstanceAttributes( polygons[p] );
          attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.BLUE.withAlpha(0.1));
        }
      }
      idList = [];
      viewer.scene.primitives._primitives.pop();
    }

    function readText(that){
        if(startMF == 1) {
          viewer.entities.removeAll();
          drawTransition(indoor);
        }
        if(that.files && that.files[0]){
            loader.loadFile(that.files[0]);
        }//end if html5 filelist support
    }
    function restart() {
      return function(){
        var envelope = document.getElementById("box").value;
        drawMultiLine(envelope);
        /*viewer.clock.currentTime = start;
        viewer.clock.startTime = start.clone();
        viewer.clock.stopTime = Cesium.JulianDate.addDays(start,1.0,new Cesium.JulianDate());
        viewer.clock.multiplier = 1.0;

        viewer.timeline.updateFromClock();
        viewer.timeline.zoomTo(viewer.clock.startTime, viewer.clock.stopTime);*/
      };
      
    }
    function viewAll() {
      return function() {
        for(var id in Index) Index[id] = 1;
        for(var id in Index) {
          if(Index[id] != preIndex[id]) {
            for(var i = 0;i < ControlVisible[id].length;i++ ) {
                var attributes = viewer.scene.primitives._primitives[0].getGeometryInstanceAttributes( ControlVisible[id][i][0]);
                var tempcolor;
                if(ControlVisible[id][i][1] == 1) tempcolor = Cesium.Color.GREEN.withAlpha(0.1);
                else if(ControlVisible[id][i][1] == 2) tempcolor = Cesium.Color.VIOLET.withAlpha(0.1);
                else if(ControlVisible[id][i][1] == 3) tempcolor = Cesium.Color.YELLOW.withAlpha(1);
                else if(ControlVisible[id][i][1] == 4) tempcolor = Cesium.Color.BLACK.withAlpha(0.3);
                attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(tempcolor);
              }
            for(var i = 0;i < ControlVisibleLine[id].length;i++ ) {
              var attributes = viewer.scene.primitives._primitives[1].getGeometryInstanceAttributes( ControlVisibleLine[id][i]);
              attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.BLACK.withAlpha(0.2));
            }
            preIndex[id] = Index[id];
          }
        }
      };
    }
    function controlLine(id,alpha) {
      var attributes = viewer.scene.primitives._primitives[1].getGeometryInstanceAttributes(id);
      attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.BLACK.withAlpha(alpha));
    }

    function enableFloor() {
      //var alpha = 0;
      //if(checked) alpha = 0.2;
      var list = document.getElementById("floor").value.split(",");
      for(var id in Index) Index[id] = 0;
      for(var k = 0;k < list.length; k++) {
        Index[list[k]] = 1;
      }
      for(var id in Index) {
        if(Index[id] != preIndex[id]) {
          for(var i = 0;i < ControlVisible[id].length;i++ ) {
              var attributes = viewer.scene.primitives._primitives[1].getGeometryInstanceAttributes( ControlVisible[id][i][0]);
              var tempcolor;
              if(ControlVisible[id][i][1] == 1) tempcolor = Cesium.Color.GREEN.withAlpha(Index[id] * 0.1);
              else if(ControlVisible[id][i][1] == 2)tempcolor = Cesium.Color.VIOLET.withAlpha(Index[id] * 0.1);
              else if(ControlVisible[id][i][1] == 3)tempcolor = Cesium.Color.YELLOW.withAlpha(Index[id]);
              else if(ControlVisible[id][i][1] == 4)tempcolor = Cesium.Color.WHITE.withAlpha(Index[id]);
              else tempcolor = Cesium.Color.BLUE.withAlpha(Index[id] * 0.1);
              attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(tempcolor);
            }
          for(var i = 0;i < ControlVisibleLine[id].length;i++ ) {
            var attributes = viewer.scene.primitives._primitives[2].getGeometryInstanceAttributes( ControlVisibleLine[id][i]);
            attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.BLACK.withAlpha(Index[id] * 0.2));
          }
          preIndex[id] = Index[id];
        }
      }

      /*if(color == 1) {
        for(var id in room) {
           var attributes = viewer.scene.primitives._primitives[0].getGeometryInstanceAttributes(id);
           attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.GREEN.withAlpha(alpha));
        }
        for(var id in roomline) {
          //console.log(id);
           controlLine(id,alpha);
           //var attributes = viewer.scene.primitives._primitives[0].getGeometryInstanceAttributes(id);
           // attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.BLACK.withAlpha(alpha));
        }
      }
      else if(color == 2) {
        for(var id in corridor) {
           var attributes = viewer.scene.primitives._primitives[0].getGeometryInstanceAttributes(id);
           attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.VIOLET.withAlpha(alpha));
        }
        for(var id in corridorline) {
           controlLine(id,alpha);
        }
      }
      else if(color == 3) {
        for(var id in stair) {
           var attributes = viewer.scene.primitives._primitives[0].getGeometryInstanceAttributes(id);
           attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.YELLOW.withAlpha(alpha));
        }
        for(var id in stairline) {
           controlLine(id,alpha);
        }
      }
      else if(color == 4){
        for(var id in door) {
           var attributes = viewer.scene.primitives._primitives[0].getGeometryInstanceAttributes(id);
           attributes.color = Cesium.ColorGeometryInstanceAttribute.toValue(Cesium.Color.WHITE.withAlpha(alpha));
        }
        for(var id in doorline) {
           controlLine(id,alpha);
        }
      }*/
    }

  /*viewer.canvas.addEventListener('click', function(e){
    var mousePosition = new Cesium.Cartesian2(e.clientX, e.clientY);

    var ellipsoid = viewer.scene.globe.ellipsoid;
    var cartesian = viewer.camera.pickEllipsoid(mousePosition, ellipsoid);
    if (cartesian) {
        var cartographic = ellipsoid.cartesianToCartographic(cartesian);
        var longitudeString = Cesium.Math.toDegrees(cartographic.longitude).toFixed(5);
        var latitudeString = Cesium.Math.toDegrees(cartographic.latitude).toFixed(5);

        alert(longitudeString + ', ' + latitudeString);
        alert(cartesian.x + ', ' + cartesian.y);
    } else {
        alert('Globe was not picked');
    }

}, false);*/

  </script>

</body>
</html>
